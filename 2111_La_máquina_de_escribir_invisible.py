# https://jv.umsa.bo/oj/problem.php?id=2111
#  La máquina de escribir invisible
#  Enviar
#  Estado
#  Descripción
#    La incompetencia cínica del Jefe Gorgory se da a conocer en todo su esplendor en la estación de policias, cuando Homero va a realizar una "denuncia" y el Jefe Gorgory le responde“Interesante, lo escribiré en mi máquina de escribir invisible”, luego de esto el Jefe Gorgory se da cuenta que su maquina de escribir invisible solo contiene $3$ botones $1$, $2$ y $3$ ,con laque forma una cadena $s$ tal que cada uno de sus caracteres sea $1$, $2$ o $3$.
#    La incompetencia cínica del Jefe Gorgory se da a conocer en todo su esplendor en la estación de policias, cuando Homero va a realizar una "denuncia" y el Jefe Gorgory le responde“Interesante, lo escribiré en mi máquina de escribir invisible”, luego de esto el Jefe Gorgory se da cuenta que su maquina de escribir invisible solo contiene $3$ botones $1$, $2$ y $3$ ,con laque forma una cadena $s$ tal que cada uno de sus caracteres sea $1$, $2$ o $3$.
#    La incompetencia cínica del Jefe Gorgory se da a conocer en todo su esplendor en la estación de policias, cuando Homero va a realizar una "denuncia" y el Jefe Gorgory le responde“Interesante, lo escribiré en mi máquina de escribir invisible”, luego de esto el Jefe Gorgory se da cuenta que su maquina de escribir invisible solo contiene $3$ botones $1$, $2$ y $3$ ,con laque forma una cadena $s$ tal que cada uno de sus caracteres sea $1$, $2$ o $3$.
#    El jefe Gorgory quiere elegir la subcadena contigua más corta de $s$ de manera que contenga cada uno de estos tres caracteres al menos una vez. Ayudalo!
#    El jefe Gorgory quiere elegir la subcadena contigua más corta de $s$ de manera que contenga cada uno de estos tres caracteres al menos una vez. Ayudalo!
#    El jefe Gorgory quiere elegir la subcadena contigua más corta de $s$ de manera que contenga cada uno de estos tres caracteres al menos una vez. Ayudalo!
#    Una subcadena contigua de la cadena $s$ es una cadena que se puede obtener de $s$ eliminando algunos caracteres (posiblemente cero) del principio de $s$ y algunos caracteres (posiblemente cero) del final de $s$.
#    Una subcadena contigua de la cadena $s$ es una cadena que se puede obtener de $s$ eliminando algunos caracteres (posiblemente cero) del principio de $s$ y algunos caracteres (posiblemente cero) del final de $s$.
#    Una subcadena contigua de la cadena $s$ es una cadena que se puede obtener de $s$ eliminando algunos caracteres (posiblemente cero) del principio de $s$ y algunos caracteres (posiblemente cero) del final de $s$.
#    Una subcadena contigua de la cadena $s$ es una cadena que se puede obtener de $s$ eliminando algunos caracteres (posiblemente cero) del principio de $s$ y algunos caracteres (posiblemente cero) del final de $s$.
#   Entrada
#    La primera línea contiene un número entero $t$ ($1 \leq t \leq 20000$): el número de casos de prueba.
#    La primera línea contiene un número entero $t$ ($1 \leq t \leq 20000$): el número de casos de prueba.
#    La primera línea contiene un número entero $t$ ($1 \leq t \leq 20000$): el número de casos de prueba.
#    Cada caso de prueba consta de una línea que contiene la cadena $s$ ($1 \leq len(s) \leq 200000$). Se garantiza que cada carácter de $s$ sea $1$, $2$ o $3$.
#    Cada caso de prueba consta de una línea que contiene la cadena $s$ ($1 \leq len(s) \leq 200000$). Se garantiza que cada carácter de $s$ sea $1$, $2$ o $3$.
#    Cada caso de prueba consta de una línea que contiene la cadena $s$ ($1 \leq len(s) \leq 200000$). Se garantiza que cada carácter de $s$ sea $1$, $2$ o $3$.
#    La suma de longitudes de todas las cadenas en todos los casos de prueba no excede $200000$.
#    La suma de longitudes de todas las cadenas en todos los casos de prueba no excede $200000$.
#    La suma de longitudes de todas las cadenas en todos los casos de prueba no excede $200000$.
#   Salida
#    Para cada caso de prueba, imprima un número entero: la longitud de la subcadena contigua más corta de $s$ que contiene los tres tipos de caracteres al menos una vez. Si no existe tal subcadena, imprima $0$ en su lugar.
#    Para cada caso de prueba, imprima un número entero: la longitud de la subcadena contigua más corta de $s$ que contiene los tres tipos de caracteres al menos una vez. Si no existe tal subcadena, imprima $0$ en su lugar.
#    Para cada caso de prueba, imprima un número entero: la longitud de la subcadena contigua más corta de $s$ que contiene los tres tipos de caracteres al menos una vez. Si no existe tal subcadena, imprima $0$ en su lugar.
#   Ejemplo Entrada
#    7123122221333333321122333322111212121233333331121
#   Ejemplo Salida
#    3344004
#   Ayuda
#    Considere la prueba de ejemplo:
#    Considere la prueba de ejemplo:
#    Considere la prueba de ejemplo:
#    En el primer caso de prueba, se puede utilizar la subcadena $123$.En el segundo caso de prueba, se puede utilizar la subcadena $213$.En el tercer caso de prueba, se puede utilizar la subcadena $1223$.En el cuarto caso de prueba, se puede utilizar la subcadena $3221$.En el quinto caso de prueba, no hay carácter $3$ en $s$.En el sexto caso de prueba, no hay carácter $1$ en $s$.En el séptimo caso de prueba, se puede utilizar la subcadena $3112$.
#    En el primer caso de prueba, se puede utilizar la subcadena $123$.En el segundo caso de prueba, se puede utilizar la subcadena $213$.En el tercer caso de prueba, se puede utilizar la subcadena $1223$.En el cuarto caso de prueba, se puede utilizar la subcadena $3221$.En el quinto caso de prueba, no hay carácter $3$ en $s$.En el sexto caso de prueba, no hay carácter $1$ en $s$.En el séptimo caso de prueba, se puede utilizar la subcadena $3112$.
#    En el primer caso de prueba, se puede utilizar la subcadena $123$.En el segundo caso de prueba, se puede utilizar la subcadena $213$.En el tercer caso de prueba, se puede utilizar la subcadena $1223$.En el cuarto caso de prueba, se puede utilizar la subcadena $3221$.En el quinto caso de prueba, no hay carácter $3$ en $s$.En el sexto caso de prueba, no hay carácter $1$ en $s$.En el séptimo caso de prueba, se puede utilizar la subcadena $3112$.

def find_substring(S):
    start = 0
    min_length = float('inf')
    count = {str(i): 0 for i in range(1, 4)}
    distinct_count = 0

    for end in range(len(S)):
        if S[end] in count:
            count[S[end]] += 1
            if count[S[end]] == 1:
                distinct_count += 1

        while distinct_count == 3:
            min_length = min(min_length, end - start + 1)
            if S[start] in count:
                count[S[start]] -= 1
                if count[S[start]] == 0:
                    distinct_count -= 1
            start += 1

    return min_length if min_length != float('inf') else 0

for _ in range(int(input())):
    S = input()
    print(find_substring(S))    